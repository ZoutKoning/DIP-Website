<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalog</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <a href="#home" id="navbar__logo">D.I.P</a>
            <div class="navbar__toggle" id="mobile-menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
            <ul class="navbar__menu">
                <li class="navbar__item">
                   <a href="index.html" class="navbar__links" id="home-page">Home</a>
                </li>
                <li class="navbar__item">
                    <a href="about.html" class="navbar__links" id="about-page">About Page</a>
                 </li>
                 <!--Wallet will appear only once signed in-->
                 <li class="navbar__item">
                    <a href="wallet.html" class="navbar__links" id="project-page">Wallet</a>
                 </li>
                 <li class="navbar__item">
                     <a href="https://dipteam5.auth.us-east-1.amazoncognito.com/login?client_id=24572ehjeno50ma5122ql3oumd&response_type=code&scope=aws.cognito.signin.user.admin+email+openid+profile&redirect_uri=https%3A%2F%2Fwww.espn.com%2F" class="navbar__links">Sign In/Sign Up</a>
                 </li>
                 <li class="navbar__item">
                    <a href="#application" class="navbar__links" id="application-page">Apply Here</a>
                 </li>
            </ul>
        </div>
    </nav>

    <h1>Product Catalog</h1>
    <div id="product-list"></div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const productList = document.getElementById('product-list');
            try {
                const response = await fetch('http://localhost:3000/api/products');
                const products = await response.json();

                products.forEach(product => {
                    const div = document.createElement('div');
                    div.innerHTML = `<h3>${product.title}</h3><p>${product.price}</p><button onclick="addToCart('${product.id}', '${product.title}', '${product.price}')">Add to Cart</button>`;
                    productList.appendChild(div);
                });
            } catch (error) {
                console.error('Error fetching products:', error);
            }
        });

        function addToCart(productId, productTitle, productPrice) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let product = { id: productId, title: productTitle, price: productPrice };
            cart.push(product);
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(`Added ${productTitle} to cart.`);
        }
    </script>
</body>
</html>